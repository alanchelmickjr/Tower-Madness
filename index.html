<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tower Madness - Elevator Operator</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #000 0%, #1a0033 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Courier New', monospace;
            color: #0ff;
        }
        
        #game-container {
            text-align: center;
            max-width: 1100px;
            padding: 20px;
        }
        
        h1 {
            font-size: 3em;
            margin: 20px 0;
            color: #0ff;
            text-shadow: 0 0 10px #0ff, 0 0 20px #0ff, 0 0 30px #0ff;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 10px #0ff, 0 0 20px #0ff, 0 0 30px #0ff; }
            to { text-shadow: 0 0 20px #0ff, 0 0 30px #0ff, 0 0 40px #0ff, 0 0 50px #0ff; }
        }
        
        .subtitle {
            font-size: 1.5em;
            color: #f0f;
            margin-bottom: 30px;
        }
        
        #pygame-canvas {
            border: 3px solid #0ff;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
            border-radius: 10px;
            max-width: 100%;
            height: auto;
        }
        
        .controls {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #0ff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px auto;
            max-width: 800px;
        }
        
        .controls h3 {
            color: #f0f;
            margin-top: 0;
        }
        
        .controls p {
            margin: 10px 0;
            line-height: 1.6;
        }
        
        .key {
            display: inline-block;
            background: rgba(0, 255, 255, 0.2);
            border: 1px solid #0ff;
            padding: 2px 8px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        .loading {
            font-size: 1.5em;
            margin: 20px;
            animation: pulse 1.5s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .story {
            background: rgba(255, 0, 255, 0.1);
            border: 2px solid #f0f;
            border-radius: 10px;
            padding: 15px;
            margin: 20px auto;
            max-width: 800px;
            font-size: 0.9em;
            text-align: left;
        }
        
        .error {
            color: #ff0000;
            background: rgba(255, 0, 0, 0.1);
            border: 2px solid #ff0000;
            padding: 15px;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 800px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <h1>üè¢ TOWER MADNESS üè¢</h1>
        <div class="subtitle">Elevator Operator</div>
        
        <div class="story">
            <p>ü§ñ <strong>The Story:</strong> You're the elevator operator at Frontier Tower, caught between two worlds:</p>
            <p>‚¨ÜÔ∏è <strong>Floor 4:</strong> The Good Robot Lab - Where Alan builds robots powered by love</p>
            <p>‚¨áÔ∏è <strong>Basement:</strong> Evil Robot Fight Club - Red-lit chaos and destruction</p>
            <p>üéØ <strong>Your Mission:</strong> Deliver 20 passengers to their destinations before chaos erupts!</p>
        </div>
        
        <div id="loading" class="loading">‚è≥ Loading game... When loaded, press the SPACEBAR key on your keyboard!</div>
        <div id="error-message" class="error" style="display: none;"></div>
        
        <canvas id="pygame-canvas"></canvas>
        
        <div class="controls">
            <h3>üéÆ CONTROLS</h3>
            <p><span class="key">W</span> or <span class="key">‚Üë</span> - Move elevator UP</p>
            <p><span class="key">S</span> or <span class="key">‚Üì</span> - Move elevator DOWN</p>
            <p><span class="key">E</span> or <span class="key">SPACE</span> - Open/Close Doors</p>
            <p><span class="key">P</span> - Pause Game</p>
            <p><span class="key">ESC</span> - Quit to Menu</p>
            
            <h3>‚ö° SPECIAL EVENTS</h3>
            <p>üåä Watch out for FLOODS on Floor 4!</p>
            <p>üíª Survive the HACKATHON chaos!</p>
            <p>ü§ñ Keep evil robots contained in the basement!</p>
        </div>
    </div>
    
    <script type="module">
        async function loadGame() {
            const loadingDiv = document.getElementById('loading');
            const errorDiv = document.getElementById('error-message');
            const canvas = document.getElementById('pygame-canvas');
            
            try {
                // Load Pygbag/Pyodide
                loadingDiv.textContent = 'üì¶ Loading Python environment...';
                
                // Auto-focus the canvas when it appears
                const observer = new MutationObserver(() => {
                    if (canvas && canvas.width > 0) {
                        canvas.focus();
                        canvas.setAttribute('tabindex', '0');
                        canvas.style.outline = '3px solid #0ff';
                        loadingDiv.textContent = 'üéÆ Click the game screen, then press SPACEBAR to start!';
                        console.log('Canvas ready - click it and press SPACEBAR');
                    }
                });
                
                observer.observe(canvas, { attributes: true, attributeFilter: ['width', 'height'] });
                
                // Also try to focus on click
                canvas.addEventListener('click', () => {
                    canvas.focus();
                    console.log('Canvas focused - try pressing SPACEBAR now');
                });
                
                // Log keyboard events for debugging
                canvas.addEventListener('keydown', (e) => {
                    console.log('Key pressed:', e.key, e.code);
                });
                
            } catch (error) {
                console.error('Error loading game:', error);
                errorDiv.style.display = 'block';
                errorDiv.innerHTML = `
                    <h3>‚ùå Error Loading Game</h3>
                    <p>${error.message}</p>
                    <p>Please try refreshing the page or check the browser console for more details.</p>
                `;
                loadingDiv.style.display = 'none';
            }
        }
        
        // Start loading when page is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadGame);
        } else {
            loadGame();
        }
    </script>
</body>
</html>